<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="icon"
      href="https://cdn-icons-png.flaticon.com/512/10826/10826388.png"
    />
    <style>
      body {
        font-family: "Prompt", sans-serif;
        background: linear-gradient(145deg, #e8f4ff, #f8fbff);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding: 40px 10px;
      }

      .converter-card {
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
        padding: 30px 25px;
        width: 100%;
        max-width: 500px;
        transition: 0.3s;
      }

      .form-control:focus {
        border-color: #0d6efd;
        box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
      }

      .converter-card:hover {
        transform: translateY(-4px);
      }

      h3 {
        font-weight: 600;
        text-align: center;
        color: #0077cc;
      }

      h5 {
        text-align: center;
        color: #6c757d;
        margin-bottom: 20px;
      }

      label {
        font-weight: 500;
        color: #333;
      }

      input,
      select {
        border-radius: 10px !important;
      }

      #swapBtn {
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: 0.3s;
      }

      #swapBtn:hover {
        transform: rotate(180deg);
        color: white;
      }

      .btn-primary {
        background: #0077cc;
        border: none;
        border-radius: 10px;
        transition: 0.2s;
      }

      .btn-primary:hover {
        background: #005fa3;
      }

      .chart-card {
        position: static;
        width: 100%;
        background: white;
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0 3px 15px rgba(0, 0, 0, 0.2);
        margin-top: 20px;
      }

      .result-box {
        font-size: 1.2rem;
        margin-top: 15px;
        font-weight: 500;
        color: #007b55;
      }

      .history-entry:hover {
        background: rgba(0, 119, 204, 0.08);
        border-radius: 8px;
        transition: 0.2s;
      }

      .history-entry:active {
        background: rgba(0, 119, 204, 0.15);
      }

      .history-card {
        background: #f9fbff;
        border-radius: 12px;
        margin-top: 20px;
        padding: 15px;
        border: 1px solid #e0e7ef;
      }

      .history-card h5 {
        color: #0077cc;
        font-weight: 500;
      }

      .list-group-item {
        border: none;
        border-bottom: 1px solid #eee;
      }

      .list-group-item:last-child {
        border-bottom: none;
      }

      .toast {
        border-radius: 8px;
      }

      #result {
        opacity: 0;
        transition: all 0.3s ease;
      }
      #result.show {
        opacity: 1;
      }

      .modal-content {
        font-family: "Prompt", sans-serif;
      }

      .modal-body p {
        line-height: 1.6;
      }

      @media (max-width: 576px) {
        .converter-card {
          padding: 20px;
        }

        h3 {
          font-size: 1.4rem;
        }

        .btn {
          font-size: 0.95rem;
        }
      }
      @media (max-width: 768px) {
        .chart-card {
          position: static !important;
          width: 100% !important;
          margin-top: 20px;
          box-shadow: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="modal fade" id="introModal" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 rounded-4 shadow">
          <div class="modal-header bg-primary text-white rounded-top-4">
            <h5 class="modal-title text-white">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <p>‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢:</p>
            <ul>
              <li>
                <b>HTML, CSS, JavaScript</b>
              </li>
              <li>
                <b>Python</b>
              </li>
              <li>
                <b>Bootstrap 5</b>
              </li>
              <li>
                <b>jQuery</b>
              </li>
              <li>
                <b>Frankfurter API</b>
              </li>
              <li><b>LocalStorage</b></li>
            </ul>

            <p>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå:</p>
            <ol>
              <li>‡∏™‡∏£‡πâ‡∏≤‡∏á form ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏á‡∏¥‡∏ô, ‡∏õ‡∏∏‡πà‡∏°, modal, list ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</li>
              <li>layout, ‡∏™‡∏µ, modal, toast, responsive design</li>
              <li>
                logic ‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏á‡∏¥‡∏ô, swap ‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô, ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥, ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥,
                toast
              </li>
              <li>fetch Frankfurter API ‡∏°‡∏≤‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏á‡∏¥‡∏ô</li>
              <li>‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å localStorage</li>
              <li>‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡πà‡∏á‡∏Ñ‡∏£‡∏π</li>
            </ol>
            <p>
              ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢: <br />‡∏ô‡∏≤‡∏¢ ‡∏ì‡∏±‡∏è‡∏ê‡∏ì‡∏¥‡∏ä‡∏≤ ‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏ï‡∏£ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 3 ‡∏õ‡∏ß‡∏ä.3/1 IT<br />‡∏ô‡∏≤‡∏¢
              ‡∏ò‡∏ô‡∏î‡∏• ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå‡∏ô‡∏ó‡∏µ ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 5 ‡∏õ‡∏ß‡∏ä.3/1 IT
            </p>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary w-100" data-bs-dismiss="modal">
              ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="converter-card">
      <h3>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</h3>
      <h5>‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Frankfurter API</h5>
      <div class="text-center mb-3">
        <button id="showIntroBtn" class="btn">‚ÑπÔ∏è</button>
      </div>

      <div class="mb-3">
        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</label>
        <input
          id="amount"
          type="number"
          class="form-control"
          placeholder="‡πÄ‡∏ä‡πà‡∏ô 1000"
          step="0.01"
        />
      </div>

      <div class="row align-items-md-end mb-3 text-center text-md-start">
        <div class="col-12 col-md-5 mb-2 mb-md-0">
          <label>‡∏à‡∏≤‡∏Å</label>
          <select id="from" class="form-select"></select>
        </div>
        <div class="col-12 col-md-2 d-flex justify-content-center my-2 my-md-0">
          <button
            id="swapBtn"
            class="btn rounded-circle shadow-sm swap-btn"
            title="‡∏™‡∏•‡∏±‡∏ö‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô"
          >
            üîÑ
          </button>
        </div>
        <div class="col-12 col-md-5">
          <label>‡πÄ‡∏õ‡πá‡∏ô</label>
          <select id="to" class="form-select"></select>
        </div>
      </div>

      <button class="btn btn-primary w-100 mb-3" onclick="convert()">
        ‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô
      </button>

      <div class="text-center">
        <div
          class="spinner-border text-primary"
          id="loader"
          style="display: none"
        ></div>
      </div>

      <div id="result" class="text-center result-box"></div>

      <div class="history-card">
        <h5>üïí ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô</h5>
        <div class="d-flex justify-content-between mb-2">
          <button class="btn btn-sm btn-outline-danger" id="clearAllBtn">
            ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
          </button>
        </div>
        <ul
          id="history-list"
          class="list-group list-group-flush"
          style="max-height: 300px; overflow-y: auto"
        ></ul>
      </div>
      <div class="chart-card">
        <h6>üìà ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡πÅ‡∏•‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô</h6>
        <canvas id="exchangeChart" height="250"></canvas>
      </div>

      <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
        <div id="toastContainer"></div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const fromSelect = document.getElementById("from");
      const toSelect = document.getElementById("to");
      const loader = document.getElementById("loader");
      const historyList = document.getElementById("history-list");
      const resultBox = document.getElementById("result");
      const history = JSON.parse(localStorage.getItem("history") || "[]");

      const currencies = {
        AUD: "Australian Dollar",
        BGN: "Bulgarian‚ÄØLev",
        BRL: "Brazilian‚ÄØReal",
        CAD: "Canadian‚ÄØDollar",
        CHF: "Swiss‚ÄØFranc",
        CNY: "Chinese‚ÄØRenminbi Yuan",
        CZK: "Czech‚ÄØKoruna",
        DKK: "Danish‚ÄØKroner",
        EUR: "Euro",
        GBP: "British‚ÄØPound",
        HKD: "Hong‚ÄØKong‚ÄØDollar",
        HUF: "Hungarian‚ÄØForint",
        IDR: "Indonesian‚ÄØRupiah",
        ILS: "Israeli‚ÄØNew‚ÄØShekel",
        INR: "Indian‚ÄØRupee",
        ISK: "Icelandic‚ÄØKr√≥na",
        JPY: "Japanese‚ÄØYen",
        KRW: "South‚ÄØKorean‚ÄØWon",
        MXN: "Mexican‚ÄØPeso",
        MYR: "Malaysian‚ÄØRinggit",
        NOK: "Norwegian‚ÄØKrone",
        NZD: "New‚ÄØZealand‚ÄØDollar",
        PHP: "Philippine‚ÄØPeso",
        PLN: "Polish‚ÄØZ≈Çoty",
        RON: "Romanian‚ÄØLeu",
        SEK: "Swedish‚ÄØKrona",
        SGD: "Singapore‚ÄØDollar",
        THB: "Thai‚ÄØBaht",
        TRY: "Turkish‚ÄØLira",
        USD: "United‚ÄØStates‚ÄØDollar",
        ZAR: "South‚ÄØAfrican‚ÄØRand",
      };

      for (const [code, name] of Object.entries(currencies)) {
        const optionFrom = document.createElement("option");
        optionFrom.value = code;
        optionFrom.textContent = `${code} - ${name}`;
        if (code === "USD") optionFrom.selected = true;
        fromSelect.appendChild(optionFrom);

        const optionTo = document.createElement("option");
        optionTo.value = code;
        optionTo.textContent = `${code} - ${name}`;
        if (code === "THB") optionTo.selected = true;
        toSelect.appendChild(optionTo);
      }

      function formatNumber(num) {
        return Number(num).toLocaleString("en-US", {
          maximumFractionDigits: 2,
        });
      }

      history.forEach((h) => addHistoryItem(h));

      function addHistoryItem(h) {
        const li = document.createElement("li");
        li.className = "list-group-item";
        li.textContent = `${formatNumber(h.amount)} ${h.from} ‚ûú ${formatNumber(
          h.result
        )} ${h.to} (rate: ${h.rate})`;
        historyList.appendChild(li);
      }

      function showToast(msg, type = "info", time = 2000) {
        const toastId = "toast" + Date.now();
        const toastHtml = `<div id="${toastId}" class="toast align-items-center text-bg-${type} border-0" role="alert" aria-live="assertive" aria-atomic="true">
  <div class="d-flex">
    <div class="toast-body">${msg}</div>
    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
  </div></div>`;
        const container = document.getElementById("toastContainer");
        container.insertAdjacentHTML("beforeend", toastHtml);
        const toastEl = document.getElementById(toastId);
        new bootstrap.Toast(toastEl, { delay: time }).show();
        toastEl.addEventListener("hidden.bs.toast", () => toastEl.remove());
      }

      async function convert() {
        const amount = parseFloat(document.getElementById("amount").value);
        const from = fromSelect.value;
        const to = toSelect.value;
        if (!amount || amount <= 0) {
          showToast("‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", "danger");
          return;
        }
        if (from === to) {
          showToast("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô", "warning");
          return;
        }
        loader.style.display = "inline-block";
        try {
          const res = await fetch(
            `https://api.frankfurter.app/latest?amount=${amount}&from=${from}&to=${to}`
          );
          const data = await res.json();
          const result = data.rates[to];
          const rate = (result / amount).toFixed(4);
          resultBox.innerHTML = `${formatNumber(
            amount
          )} ${from} = <b>${formatNumber(
            result
          )}</b> ${to}<br><small class="text-muted">(rate: ${rate})</small>`;
          history.push({ amount, from, to, result, rate });
          localStorage.setItem("history", JSON.stringify(history));
          addHistoryItem({ amount, from, to, result, rate });
          showToast("üí± ‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "success");
          updateChart(from, to);
        } catch (e) {
          showToast("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", "danger");
        } finally {
          loader.style.display = "none";
          resultBox.classList.add("show");
        }
      }

      document.getElementById("swapBtn").addEventListener("click", () => {
        const from = fromSelect.value,
          to = toSelect.value;
        fromSelect.value = to;
        toSelect.value = from;
      });

      document.getElementById("clearAllBtn").addEventListener("click", () => {
        localStorage.removeItem("history");
        historyList.innerHTML = "";
        history.length = 0;
      });

      let exchangeChart = null;
      async function updateChart(from, to) {
        try {
          const end = new Date();
          const start = new Date();
          start.setDate(end.getDate() - 7);
          const res = await fetch(
            `https://api.frankfurter.app/${
              start.toISOString().split("T")[0]
            }..${end.toISOString().split("T")[0]}?from=${from}&to=${to}`
          );
          const data = await res.json();
          const labels = Object.keys(data.rates);
          const values = labels.map((d) => data.rates[d][to]);
          if (exchangeChart) {
            exchangeChart.destroy();
          }
          const ctx = document.getElementById("exchangeChart").getContext("2d");
          exchangeChart = new Chart(ctx, {
            type: "line",
            data: {
              labels,
              datasets: [
                {
                  label: `${from} ‚ûú ${to}`,
                  data: values,
                  borderColor: "blue",
                  tension: 0.3,
                },
              ],
            },
            options: {
              responsive: true,
              plugins: { legend: { display: false } },
            },
          });
        } catch (e) {
          console.error(e);
        }
      }

      const hasSeenIntro = localStorage.getItem("hasSeenIntro");

      if (!hasSeenIntro) {
        const introModalEl = document.getElementById("introModal");
        if (introModalEl) {
          const introModal = new bootstrap.Modal(introModalEl);
          introModal.show();

          localStorage.setItem("hasSeenIntro", "true");
        }
      }

      document.getElementById("showIntroBtn").addEventListener("click", () => {
        const introModalEl = document.getElementById("introModal");
        if (introModalEl) {
          const introModal = new bootstrap.Modal(introModalEl);
          introModal.show();
        }
      });
    </script>
  </body>
</html>
